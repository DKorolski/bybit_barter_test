# engine_sync_with_live_bybit_orderbooks_and_trades: краткое пояснение

Этот пример показывает, как запустить движок Barter в синхронном режиме и подписаться на два публичных стрима Bybit Perpetuals USD: **OrderBook L2** и **Public Trades**. Ниже — что важно знать перед запуском.

## Что делает пример
- Загружает конфигурацию инструмента `BTCUSDT` из `config/system_config_bybit_perpetual.json`, оставляя список `executions` пустым: это чисто «data-only» режим без отправки заявок.
- Создаёт мультибиржевой поток маркет-данных с двумя подписками `SubKind::OrderBooksL2` и `SubKind::PublicTrades`, затем запускает движок в `EngineFeedMode::Iterator` с включённым аудитом.
- Внутренний consumer (`audit_task`) логирует каждое полученное событие `OrderBook` и `Trade`, поэтому вы увидите ленту обновлений стакана и сделок. Пример работает ~10 секунд, после чего корректно отменяет ордера (их нет) и закрывает позиции (их нет), затем печатает `TradingSummary<Daily>`.

## Как запустить
```bash
cargo run -p barter --example engine_sync_with_live_bybit_orderbooks_and_trades
```
Требуется доступ к WebSocket Bybit (публичные маркет-фиды). Если соединение недоступно, вы увидите предупреждения/ошибки сети.

## Ожидаемый вывод
- Строка `Engine running feed_mode="sync" audit_mode="enabled"` и последующие `Audit snapshot` записи с чередующимися `OrderBook(Update(...))` и `Trade(PublicTrade { ... })` событиями.
- После 10 секунд пример завершает работу и печатает пустое `TradingSummary` (без сделок и PnL, так как исполнение отсутствует).

## Где менять настройки
- **Инструмент и биржа**: `barter/examples/config/system_config_bybit_perpetual.json` — можно добавить новые инструменты или переключить биржу (важно, чтобы клиент поддерживал соответствующий стрим).
- **Длительность работы**: изменить `Duration::from_secs(10)` в конце `main` (`engine_sync_with_live_bybit_orderbooks_and_trades.rs`).
- **Подписки**: список `SubKind` в инициализации `market_stream` — сюда можно добавить другие публичные фиды, которые поддерживает Bybit Data клиент.

## Ограничения
- Нет исполняющего контура: заявки не отправляются, пример предназначен для тестирования приёма данных и аудита.
- При нестабильной сети возможны предупреждения вида `missing field subscription_id` на служебные сообщения `pong` — они безвредны и обрабатываются механизмом переподключения.